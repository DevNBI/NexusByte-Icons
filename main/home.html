<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Home</title>
<link rel="icon" href="https://devnbi.github.io/NexusByte-Icons/assets/media/branding/logo.png">
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{background:#141414;color:#fff;font-family:Arial,Helvetica,sans-serif}
nav{position:fixed;top:0;left:0;width:100%;background:rgba(30,30,30,0.85);backdrop-filter:blur(10px);border-bottom:1px solid #333;display:flex;justify-content:space-evenly;align-items:center;padding:14px 0;z-index:1000}
nav img{width:26px;height:26px;cursor:pointer;transition:.2s}
nav img:hover{opacity:.7}
.main{width:98%;margin:100px auto 20px auto;display:grid;grid-template-columns:repeat(6,1fr);gap:16px}
.tile{border:1px solid #333;border-radius:10px;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:24px}
.tile canvas{border-radius:10px}
.space{height:18px}
.btns{display:flex;flex-direction:column;gap:10px;width:100%}
button{background:#1e1e1e;border:none;color:#fff;border-radius:10px;padding:10px;cursor:pointer;transition:.2s}
button:hover{background:#2a2a2a}
.picker{position:fixed;inset:0;background:#00000080;display:none;align-items:center;justify-content:center}
.box{background:#1e1e1e;border-radius:14px;padding:20px;display:flex;flex-direction:column;gap:14px;align-items:center}
input[type=color]{appearance:none;border:none;width:220px;height:120px;border-radius:14px;background:none;cursor:pointer}
@media(max-width:1200px){.main{grid-template-columns:repeat(4,1fr)}}
@media(max-width:900px){.main{grid-template-columns:repeat(3,1fr)}}
@media(max-width:600px){.main{grid-template-columns:repeat(2,1fr)}}
</style>
</head>
<body>
<nav>
<img src="https://devnbi.github.io/NexusByte-Icons/assets/media/icons/home.png" onclick="location.href='https://devnbi.github.io/NexusByte-Icons/main/home.html'">
<img src="https://devnbi.github.io/NexusByte-Icons/assets/media/icons/search.png" onclick="location.href='https://devnbi.github.io/NexusByte-Icons/main/search.html'">
<img src="https://devnbi.github.io/NexusByte-Icons/assets/media/icons/information.png" onclick="location.href='https://devnbi.github.io/NexusByte-Icons/main/information.html'">
</nav>
<div class="main" id="grid"></div>
<div class="picker" id="picker">
<div class="box">
<input type="color" id="color" value="#ffffff">
<button onclick="apply()">Apply</button>
<button onclick="closePicker()">Close</button>
</div>
</div>
<script>
let currentCanvas=null;
let currentColor='#ffffff';
let currentImg=null;
const displayCanvasSize=96;
const fullSize=512;

fetch('https://devnbi.github.io/NexusByte-Icons/assets/data/indexing.json')
.then(r=>r.json())
.then(data=>{
  const grid=document.getElementById('grid');
  data.forEach(url=>{
    const t=document.createElement('div');
    t.className='tile';
    t.innerHTML=`<canvas width="${displayCanvasSize}" height="${displayCanvasSize}"></canvas><div class="space"></div><div class="btns"><button>Change Colour</button><button>Download</button></div>`;
    grid.appendChild(t);

    const canvas=t.querySelector('canvas');
    const ctx=canvas.getContext('2d');

    const img=new Image();
    img.crossOrigin='anonymous';
    img.onload=()=>{
      const scale=Math.min(displayCanvasSize/img.width, displayCanvasSize/img.height);
      const w=img.width*scale;
      const h=img.height*scale;
      const x=(displayCanvasSize-w)/2;
      const y=(displayCanvasSize-h)/2;
      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.drawImage(img,x,y,w,h);
    };
    img.src=url;

    t.querySelector('button:nth-child(1)').onclick=()=>openPicker(canvas,img);
    t.querySelector('button:nth-child(2)').onclick=()=>download(img,currentColor);
  });
});

function openPicker(canvas,img){
  currentCanvas=canvas;
  currentImg=img;
  currentColor='#ffffff';
  document.getElementById('color').value=currentColor;
  document.getElementById('picker').style.display='flex';
  document.getElementById('color').oninput=()=>{
    currentColor=document.getElementById('color').value;
    const ctx=currentCanvas.getContext('2d');
    ctx.clearRect(0,0,currentCanvas.width,currentCanvas.height);
    const scale=Math.min(currentCanvas.width/currentImg.width,currentCanvas.height/currentImg.height);
    const w=currentImg.width*scale;
    const h=currentImg.height*scale;
    const x=(currentCanvas.width-w)/2;
    const y=(currentCanvas.height-h)/2;
    ctx.drawImage(currentImg,x,y,w,h);
    ctx.globalCompositeOperation='source-atop';
    ctx.fillStyle=currentColor;
    ctx.fillRect(0,0,currentCanvas.width,currentCanvas.height);
    ctx.globalCompositeOperation='source-over';
  };
}

function closePicker(){document.getElementById('picker').style.display='none';}
function apply(){closePicker();}

function download(img,color){
  const canvas=document.createElement('canvas');
  canvas.width=fullSize;
  canvas.height=fullSize;
  const ctx=canvas.getContext('2d');
  ctx.drawImage(img,0,0,fullSize,fullSize);
  ctx.globalCompositeOperation='source-atop';
  ctx.fillStyle=color;
  ctx.fillRect(0,0,fullSize,fullSize);
  ctx.globalCompositeOperation='source-over';
  const a=document.createElement('a');
  a.href=canvas.toDataURL('image/png');
  a.download='icon.png';
  a.click();
}
</script>
</body>
</html>